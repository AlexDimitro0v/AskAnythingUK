{% extends 'main/base.html' %}
{% load static %}
{% load multifor %}

{% block content%}
<div class="noselect button-corner" style="position: fixed; z-index: 1; ">
  <a href="{% url 'new-feedback-request-page' %}"  style="text-decoration:none;">
      <button class="btn btn-outline-info" style="border-width: 2px; font-size: 1.3em">Ask For Feedback</button>
  </a>
</div>
<div class="feedback-request">
    <div class="decorative-text-wrapper noselect">My Profile</div>
    <div class="cardbody"  style="margin-top:50px">
      <img class="photo-circle" style="display: table; margin: 0 auto; width: 150px; height: 150px; border-radius: 100%; border: 8px solid #eee" src="{{ user.userprofile.image.url }}"/>
      <h3 style="text-align: center; margin: 20px; font-size: 26px"><strong>{{ user.username }}</strong></h3>
      <div class="border-top pt-1"></div>

        {% if user.userprofile.description %}
            <p>{{ user.userprofile.description }}</p>
        {% else %}
            <p>No profile description.</p>
        {% endif %}

        <div class="noselect button-corner">
          <a href="{% url 'profile-page' %}" style="text-decoration:none; margin-right: 5px">
            <button class="btn btn-outline-info" >View Profile</button>
          </a>
          <a href="{% url 'customize-profile-page' %}" style="text-decoration:none;">
              <button class="btn btn-outline-info">Customize Profile</button>
          </a>
        </div>
    </div>

</div>

<div class="feedback-request">
  <div class="decorative-text-wrapper noselect">My Requests</div>
  <div class="cardbody" style="margin-bottom: 0">
  {% if my_requests %}
        {% for feedback_request in my_requests; curr_candidates in feedback_candidates %}
        <div>
            <div class="small-card" style="padding: 20px">
                <div class="feedback-request-link">
                  <a  href="{% url 'feedback-request-page' %}?request_id={{feedback_request.id}}"><p style="text-align: center; font-size: 1.2em; font-weight: 600">{{feedback_request.title}}</p></a>
                </div>
                <div class="border-top mb-3 mt-3"></div>
                {% if curr_candidates%}
                <div>
                {% for candidate in curr_candidates%}       <!--For username in User instance-->
                <div style="margin-bottom: 10px">
                  <span class="feedback-request-link" style="display: inline-block; padding-left: 20px; padding-right: 20px">
                  <a href="{% url 'profile-page' %}?user={{candidate}}&feedback={{feedback_request.id}}">
                  <img class="photo-circle" src="{{ candidate.userprofile.image.url }}"/>
                  <span style="margin-left: 10px; font-weight: 600">{{candidate}}</span>
                  </a>
                  </span>
                  <a href="{% url 'choose-feedbacker-page' %}?user={{candidate}}&feedback={{feedback_request.id}}">
                    <div class="status-info-button status-info-profile">
                        Choose as Feedbacker
                    </div>
                  </a>
                </div>
                {% endfor %}
              </div>
                {% elif feedback_request.feedbacker != feedback_request.feedbackee %}
                <div>
                  <span class="feedback-request-link" style="display: inline-block; padding-left: 20px; padding-right: 20px">
                  <a href="{% url 'profile-page' %}?user={{feedback_request.feedbacker}}&feedback={{feedback_request.id}}">
                  <img class="photo-circle" src="{{ feedback_request.feedbacker.userprofile.image.url }}"/>
                  <span style="margin-left: 10px; font-weight: 600">{{feedback_request.feedbacker}}</span>
                  </a>
                  </span>
                  <div class="status-info status-info-profile noselect" style="background-color: #AC6DFF; font-size: 1em;">Your Feedbacker</div>
                </div>
                {% else %}
                <p style="text-align: center">No Feedbacker Candidates Yet</p>
                {% endif %}
              </div>
        </div>
        {% endfor %}
  {% else%}
        <p style="text-align: center; font-size: 1.2em; font-weight: 600; ">No Posted Requests</p>
  {% endif %}

  </div>
</div>


<div class="feedback-request">
    <div class="decorative-text-wrapper noselect">My Feedbacker Applications</div>
    <div class="cardbody" style="margin-bottom: 0">
    {% if my_applications %}
        {% for application in my_applications %}
        <a href="{% url 'feedback-request-page' %}?request_id={{application.id}}" style="text-decoration: none;">
        <div class="small-card small-card-hover">
            {{application.title}}
            {% if application.feedbacker == user %}
            <div class="status-info status-info-profile noselect" style="background-color: #48EB9E; font-size: 1em;">Application Accepted</div>
            {% elif application.feedbacker == application.feedbackee %}
            <div class="status-info status-info-profile noselect" style="background-color: #FFB580; font-size: 1em;">Application Submitted</div>
            {% else %}
            <div class="status-info status-info-profile noselect" style="background-color: #FF6571; font-size: 1em;">Application Rejected</div>
            {% endif %}
        </div>
        </a>
        {% endfor %}
    {% else%}
        <p style="text-align: center; font-size: 1.2em; font-weight: 600; ">No Submitted Requests</p>
    {% endif %}
    </div>
</div>

{% endblock %}
